# 从一开始搭建json库教程

## 面向真正的新手，从我自己足够菜鸟的角度出发。

当我想用C++\C做一些自己的项目的时候，搜出来比较简单的项目之中就有JSON库。中文教程中比较多人推荐的应该就是叶劲峰老师的[从零开始的 JSON 库教程](https://zhuanlan.zhihu.com/p/22457315)，老师写得很好，也在每个章节设置了该完成的任务，跟打游戏一样。但对于真正的新手而言，我指像我这样真的很菜的菜鸟，我觉得不够清晰，也不够全面。而且有一个点，我想用C++写。

然后，我在github找到Andrew Twyman老师写的一套使用C++11标准的库[json11](https://github.com/dropbox/json11)，恰巧我刚好在读《深入理解C++11》（前年就买了，一直没读完，希望这次能一口气研究完，就我一个菜鸟的四年工作经验而言，C++11都还没普及使用）

在研究了叶劲峰老师的教程和Andrew Twyman老师的库之后，我觉得我可以写一个更详细的使用C++11搭建JSON库的中文教程，我做的这些工作都是站在巨人的肩膀上的一些微小的工作，所以我才把这个教程叫做从**从一开始搭建json库教程**。

写教程的另外一个目的是我了解到最好的学习方法是寓教于学，因为能把项目面向一个真的新手讲清楚，就证明肯定也能面向面试官讲清楚。推荐大家将自己学习的经验写下来，会有助于自己的理解，在这同时能帮到真的需要帮助的朋友那就更好了。如果大佬们有空有幸读到本教程，看出有什么疏漏错误的话，希望在评论区指出，虽然大佬也不需要看这种教程。

## 当我们在谈论json库的时候，我们在谈论什么？

### 什么是json？

以下是一个json字符串
~~~
{
  "name": "Jane Doe",
  "age": 30,
  "isEmployee": true,
  "address": {
    "street": "123 Main St",
    "city": "Anytown",
    "zipcode": "12345"
  },
  "phoneNumbers": [
    {
      "type": "home",
      "number": "212-555-1234"
    },
    {
      "type": "office",
      "number": "646-555-4567"
    }
  ],
  "projects": [
    {
      "id": 1,
      "name": "Project Phoenix",
      "dueDate": "2024-12-31"
    },
    {
      "id": 2,
      "name": "Project Apollo",
      "status": "in-progress",
      "teamMembers": ["Bob", "Alice", "John"]
    }
  ]
}
~~~

我一开始对json的了解也仅限于知道他是一种存储数据的结构，因为没正式接触过，仅在工作中偶尔查日志的时候会碰到。查阅中文维基可以得到定义。

JSON格式是1999年《JavaScript Programming Language, Standard ECMA-262 3rd Edition》的子集合，所以可以在JavaScript以eval()函数（javascript通过eval()调用解析器）读入。不过这并不代表JSON无法使用于其他语言，事实上几乎所有与网络开发相关的语言都有JSON函式库。

JSON的基本数据类型：

**数值**：十进制数，不能有前导0，可以为负数，可以有小数部分。还可以用e或者E表示指数部分。不能包含非数，如NaN。不区分整数与浮点数。JavaScript用双精度浮点数表示所有数值（后来也支持 BigInt[1]）。
**字符串**：以双引号""括起来的零个或多个Unicode码位。支持反斜杠开始的转义字符序列。
**布尔值**：表示为true或者false。
**数组**：有序的零个或者多个值。每个值可以为任意类型。数组使用方括号[]包裹。多个数组元素之间用逗号,分隔，形如：[value, value]。
**对象**：若干无序的“键-值对”(key-value pairs)，其中键只能是字符串[2]。建议但不强制要求对象中的键是独一无二的。对象以花括号{}包裹。多个键-值对之间使用逗号,分隔。键与值之间用冒号:分隔。
**空值**：值写为null

### json库需要做什么？

询问GPT得到，一个json库的核心功能是以下两个主要方面：

1. **解析**: 将json格式的文本字符串解码转换为相应编程语言的数据结构（例如在Python中可能是字典和列表，在C++中可能是`std::map`, `std::vector`等）。

2. **生成**: 将编程语言中的数据结构编码转换为标准的JSON格式的文本字符串。


### 规划方向

既然已经了解了json是什么，也清楚json库应该干什么，我们就可以开始围绕功能进行规划代码。

![pics1](pics\\初版流程图.png)

